<section class="wrap">
  <h1>Alertas Activas</h1>

  <input 
    class="search" 
    type="search" 
    placeholder="Buscar Alerta" 
     />
    <div class="grid">
         <app-card-alerta-a
    *ngFor="let a of alertas()"
      [alerta]="a"
      (ver)="openDetalle(a)"
      >>

        </app-card-alerta-a>
    </div>


<div class="modal-backdrop" *ngIf="isModalOpen" (click)="closeModal()"></div>

<div class="alert-modal" *ngIf="isModalOpen" (click)="$event.stopPropagation()" role="dialog" aria-modal="true">
  <button class="close" (click)="closeModal()" aria-label="Cerrar">✖</button>

  <h2 class="ttl">
    Alerta de Nivel: <span>{{ selected?.nivel }}</span>
  </h2>

  <p class="pac"><b>Paciente:</b> {{ selected?.paciente }}</p>

  <div class="mini-card">
    <div><b>Nivel de glucosa:</b> {{ selected?.glucosa }}</div>
    <div><b>Hora:</b> {{ selected?.hora }}</div>
    <div><b>Momento:</b> {{ selected?.momento }}</div>
    <div><b>Observacion durante la muesta:</b></div>
    <div>{{selected?.observaciones}}</div>
  </div>

  <label class="lbl">Respuesta:</label>
  <textarea [(ngModel)]="respuesta" rows="4" placeholder="Escribe tu respuesta..."></textarea>

  <button class="btn-resolver" (click)="resolver()">Resolver</button>
</div>



<!-- BACKDROP -->
<div class="success-backdrop" *ngIf="isSuccessOpen" (click)="isSuccessOpen=false"></div>

<!-- MODAL DE ÉXITO -->
<div class="success-modal" 
     *ngIf="isSuccessOpen" 
     (click)="$event.stopPropagation()"
     role="alert"
     aria-live="assertive">

  <div class="icon">✔</div>

  <h3>¡Alerta Resuelta!</h3>

  <p>La respuesta fue registrada correctamente.</p>

  <button class="ok-btn" (click)="isSuccessOpen=false">Aceptar</button>
</div>


<!-- BACKDROP - ERROR -->
<div class="error-backdrop" *ngIf="isErrorOpen" (click)="isErrorOpen=false"></div>

<!-- MODAL DE ERROR -->
<div class="error-modal"
     *ngIf="isErrorOpen"
     (click)="$event.stopPropagation()"
     role="alert"
     aria-live="assertive">

  <div class="error-icon">✖</div>

  <h3>Ocurrió un error</h3>

  <p>{{ errorMessage || 'No se pudo registrar la respuesta. Intenta nuevamente.' }}</p>

  <button class="error-ok" (click)="isErrorOpen=false">Cerrar</button>
</div>

</section>


